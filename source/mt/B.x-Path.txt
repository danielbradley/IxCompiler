
.. Path

~!include/ix/Path.h~
#ifndef IX_PATH_H
#define IX_PATH_H

Path* Path_new( const char* target );

Path*       Path_free       (       Path** self );
bool        Path_exists     ( const Path*  self );
bool        Path_canWrite   ( const Path*  self );
const char* Path_getFullPath( const Path*  self );
Path*       Path_getParent  ( const Path*  self );

#endif
~

~!c/ix/Path.c~
#include <stdlib.h>
#include "ix.h"

struct _Path
{
    bool  exists;
    bool  canWrite;
    char* path;
};
~

~c/ix/Path.c~
Path* Path_new( const char* target )
{
    Path* self = calloc( 1, sizeof( Path ) );
    if ( self )
    {
        self->exists   = Platform_Location_IsDirectory( target );
        self->canWrite = Platform_Location_IsWritable ( target );
        self->path     = Platform_Location_FullPath   ( target );
    }

    return self;
}
~

~c/ix/Path.c~
Path* Path_free( Path** self )
{
    free( (*self)->path );
    free( *self ); *self = 0;

    return *self;
}
~

~c/ix/Path.c~
bool Path_exists( const Path* self )
{
    return self->exists;
}
~

~c/ix/Path.c~
bool Path_canWrite( const Path* self )
{
    return self->canWrite;
}
~

~c/ix/Path.c~
const char* Path_getFullPath( const Path* self )
{
    return self->path;
}
~

~c/ix/Path.c~
Path* Path_getParent( const Path* self )
{
    Path* ret  = null;
    char* path = String_Copy( Path_getFullPath( self ) );
    int   n    = String_Length( path ) - 1;

    if ( '/' == path[n] )
    {
        path[n] = '\0';
        n--;
    }

    while ( 0 <= n )
    {
        if ( '/' == path[n] ) break;
        
        path[n--] = '\0';
    }

    ret = Path_new( path );

    Platform_Free( &path );

    return ret;
}
~
